## Занятие 02 «Дисковая подсистема»
## Задание
Домашнее задание
работа с mdadm.  
добавить в Vagrantfile еще дисков  
сломать/починить raid  
собрать R0/R5/R10 на выбор  
прописать собранный рейд в конф, чтобы рейд собирался при загрузке  
создать GPT раздел и 5 партиций

в качестве проверки принимаются - измененный Vagrantfile, скрипт для создания рейда, конф для автосборки рейда при загрузке  
"*" доп. задание - Vagrantfile, который сразу собирает систему с подключенным рейдом  
"**" перенесети работающую систему с одним диском на RAID 1. Даунтайм на загрузку с нового диска предполагается. В качестве проверики принимается вывод команды lsblk до и после и описание хода решения (можно воспользовать утилитой Script).
## Инвентарь

ПО:
- **VirtualBox** - среда виртуализации, позволяет создавать и выполнять виртуальные машины;
- **Vagrant** - ПО для создания и конфигурирования виртуальной среды. В данном случае в качестве среды виртуализации используется *VirtualBox*;
- **Git** - система контроля версий

Аккаунты:
- **GitHub** - https://github.com/

Материалы к заданию из личного кабинета:
- **Методичка_Дисковая подсистема RAID_Linux.pdf**

URLs:  
<https://github.com/erlong15/otus-linux>
 
## Порядок выполнения задания
#### 1. Устанавливаем необходимое ПО
* **GIT**
* **VirtualBox**
* **Vagrant**
#### 2. Конфигурируем vagrantfile
Согласно методичке **"Методичка_Дисковая подсистема RAID_Linux.pdf"**, сконфигурируем **vagrantfile** на основе примера из <https://github.com/erlong15/otus-linux>  
Для того чтобы изменить директорию расположения файлов дисков (.vdi), пропишем переменную **home**, которая позволит сохранять диски не в директории с файлом **Vagrant**, это связано с параметром **synced_folder** из Вагрант файла, в случае использования которого, созданные диски (.vdi) могут быть проброшены на гостевую OS, что может привести сбою в связи с переполнением диска гостевой OS.
```ruby
***
home = ENV['HOME'] 
***
```
Для добавления новых дисков в необходимом количестве пропишем в  **Vagrantfile** конфигурацию следующего типа:
```ruby
***
      # disks
        :sata1 => {
          :dfile => home + '/VirtualBox VMs/sata1.vdi',
          :size => 250,
          :port => 1
          },
        :sata2 => {
          :dfile => home + '/VirtualBox VMs/sata2.vdi',
          :size => 250, # Megabytes
          :port => 2
          },
        :sata3 => {
          :dfile => home + '/VirtualBox VMs/sata3.vdi',
          :size => 250,
          :port => 3
          },
        :sata4 => {
          :dfile => home + '/VirtualBox VMs/sata4.vdi',
          :size => 250, # Megabytes
          :port => 3
          }
        }
***
```
Полученной конфигурации достаточно для выполнения задания:  
- собрать R0/R5/R10 на выбор  
- сломать/починить raid  
#### 2. Создаем RAID
После того как сконфигурировали **Vagrantfile** с дополнительными **4-мя дисками**, поднимет **box** и заходим на него и проверяем диски командой **lsblk**.
```bash
$ lsblk
```
Вывод команды будет выглядеть следующим образом
```bash
NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda      8:0    0   40G  0 disk
`-sda1   8:1    0   40G  0 part /
sdb      8:16   0  250M  0 disk
sdc      8:32   0  250M  0 disk
sdd      8:48   0  250M  0 disk
sde      8:64   0  250M  0 disk
```
Видим, что по мимо раздела с OS, в системе появилось еще 4-ре дополнительных диска (sdb,sdc,sdd,sde).
